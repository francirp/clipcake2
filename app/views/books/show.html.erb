<center><h1><%= @book.name %></h1></center>


<h2>Contributors</h2>
  <ul>
    <% @book.roles.each do |role| %>
      <li><%= role.user.full_name %>
        <% i = 1 %>
        <% Page.where(:user_id => role.user.id).where(:book_id => role.book_id).each do |page| %>
          <%= link_to "##{i}", page_url(page.id), :class => "btn btn-primary btn-mini" %>
          <% i += 1 %>
        <% end %>
      </li>
    <% end %>
  </ul>

<h2>Pages</h2>
<h3><%= link_to 'Add a New Page', "#{new_page_url}?book_id=#{@book.id}" %></h3>

<% i = 0 %>
<% @book.pages.order("position asc").each do |page| %>
  <% i += 1 %>
  <div class="book-show">
    <%= form_tag(page_url(page), :method => 'put') do %>
      <h4><%= page.user.full_name %> posted page #: <%= number_field_tag :position, page.position, :class => "input-mini" %>
        <button type="submit" class="btn btn-default">Update Position</button></h4>
    <% end %>

  </div>
  <%= render :partial => "page_layouts/#{page.layout}", :locals => { :page => page } %>
  <div class="book-show">
    <%= link_to image_tag("iconmonstr-trash-can-15-icon.png", :class => 'edit-button right'), page_url(page.id), :method => 'delete', data: { confirm: "Do you really want to delete this page?" } %>
    <%= link_to image_tag("iconmonstr-edit-9-icon.png", :class => 'edit-button right'), edit_page_url(page.id) %>
  </div>
  <br />
  <br />
<% end %>
