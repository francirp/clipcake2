<div class="<%= styleclass %> left" id="<%= "#{page.id}#{formnum}" %>">
  <a href="#_" class="fill-div" id="pop<%= "#{page.id}#{formnum}" %>">
    <% if position.present? %>
        <% if position.class == Photo %>
          <div class="background" style="background-image: url(<%= position.source_url %>);"></div>
        <% else %>
          <%= simple_format(position.message) %>
        <% end %>
    <% elsif page.user == current_user || page.book.captain == current_user %>

    <% end %>
    <%= render :partial => "/page_layouts/popup.html.erb", :locals => { :page => page, :formnum => formnum } %>
  </a>
  <% if position.present? %>
    <%= form_tag("/page/#{page.id}/position/#{position.position}", :id => "photo_submit", :method => "post", remote: true) do %>
      <%= hidden_field_tag "inputPhotoTarget", "image_url" %>
    <% end %>
  <% end %>
</div>

<script>

          $( init );

          function init() {
                    $('.fill-div').droppable({
                        accept: "li.ui-draggable",
                        drop: function( event, ui ) {
                          addPicture(ui.draggable,$(this));
                        }
                      });
                      }

          function addPicture($item_draggable,$item_droppable) {
            var $img_src = $item_draggable.find("img").attr("src")
            var $new_background = 'url('  + $img_src + ')'
            var $result = ($item_droppable).find(".background").css("background-image",$new_background)
          }

</script>

